{"version":3,"sources":["scripts/main.js"],"names":["startGamePress","buttonStart","document","querySelector","tableBody","score","message","querySelectorAll","lose","win","gameField","children","map","el","fieldTurnRows","reduce","acc","curr","i","length","push","reversField","rev","reverse","reversFieldTurnRows","startGame","eventStart","currentTarget","classList","remove","add","textContent","forEach","m","removeStyleCell","clearCell","fillRandomCell","moveItem","eventKey","preventDefault","includes","key","move","Error","state","gameOver","addScore","field","e","j","target","mergeMove","targ","cell","className","random2And4","arrNum","fill","Math","round","random","getRandom","max","min","floor","emptyCells","flat","filter","addStyleCell","row","a","num","over","addEventListener","window"],"mappings":"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","file":"main.255d0bb3.js","sourceRoot":"..\\src","sourcesContent":["'use strict';\r\n\r\nconst buttonStart = document.querySelector('.start');\r\nconst tableBody = document.querySelector('tbody');\r\nconst score = document.querySelector('.game-score');\r\nconst message = document.querySelectorAll('.message');\r\n\r\nconst [lose, win] = message;\r\nconst gameField = [...tableBody.children].map(el => [...el.children]);\r\nconst fieldTurnRows = gameField.reduce((acc, curr) => {\r\n  for (let i = 0; i < curr.length; i++) {\r\n    acc[i].push(curr[i]);\r\n  }\r\n\r\n  return acc;\r\n}, [[], [], [], []]);\r\nconst reversField = gameField.map(rev => [...rev].reverse());\r\nconst reversFieldTurnRows = fieldTurnRows.map(rev => [...rev].reverse());\r\nlet startGamePress;\r\n\r\nbuttonStart.addEventListener('click', startGame);\r\nwindow.addEventListener('keydown', moveItem);\r\n\r\nfunction startGame(eventStart) {\r\n  startGamePress = true;\r\n  eventStart.currentTarget.classList.remove('start');\r\n  eventStart.currentTarget.classList.add('restart');\r\n  eventStart.currentTarget.textContent = 'restart';\r\n  score.textContent = 0;\r\n  message.forEach(m => m.classList.add('hidden'));\r\n\r\n  removeStyleCell();\r\n  clearCell();\r\n  fillRandomCell();\r\n  fillRandomCell();\r\n}\r\n\r\nfunction moveItem(eventKey) {\r\n  eventKey.preventDefault();\r\n\r\n  const arrKey = ['ArrowUp', 'ArrowDown', 'ArrowRight', 'ArrowLeft'];\r\n\r\n  if (!arrKey.includes(eventKey.key) || !startGamePress) {\r\n    return;\r\n  }\r\n\r\n  switch (eventKey.key) {\r\n    case 'ArrowUp':\r\n      move(fieldTurnRows);\r\n      break;\r\n    case 'ArrowDown':\r\n      move(reversFieldTurnRows);\r\n      break;\r\n    case 'ArrowRight':\r\n      move(reversField);\r\n      break;\r\n    case 'ArrowLeft':\r\n      move(gameField);\r\n      break;\r\n    default:\r\n      throw Error('key no move');\r\n  }\r\n\r\n  const state = fillRandomCell();\r\n\r\n  if (!state) {\r\n    gameOver(addScore(0), !state);\r\n  }\r\n}\r\n\r\nfunction move(field) {\r\n  field.forEach(e => {\r\n    for (let i = 1; i < e.length; i++) {\r\n      if (e[i].textContent === '') {\r\n        continue;\r\n      }\r\n\r\n      let target;\r\n      let j = i - 1;\r\n\r\n      while (\r\n        j >= 0\r\n        && (e[j].textContent === ''\r\n        || e[j].textContent === e[i].textContent)\r\n      ) {\r\n        target = e[j];\r\n        j--;\r\n      }\r\n\r\n      if (!target) {\r\n        continue;\r\n      }\r\n\r\n      mergeMove(target, e[i]);\r\n    }\r\n  });\r\n}\r\n\r\nfunction mergeMove(targ, cell) {\r\n  if (targ.textContent === '') {\r\n    targ.textContent = cell.textContent;\r\n    cell.textContent = '';\r\n    cell.className = 'field-cell';\r\n  }\r\n\r\n  if (targ.textContent === cell.textContent) {\r\n    targ.textContent = cell.textContent * 2;\r\n    cell.textContent = '';\r\n    cell.className = 'field-cell';\r\n    addScore(targ.textContent);\r\n    gameOver(targ.textContent);\r\n  }\r\n}\r\n\r\nfunction random2And4() {\r\n  const arrNum = [4];\r\n\r\n  arrNum.length = 10;\r\n  arrNum.fill(2, 1);\r\n\r\n  return arrNum[Math.round(Math.random())];\r\n}\r\n\r\nfunction getRandom(max, min = 0) {\r\n  return Math.floor(Math.random() * (max - min) + min);\r\n}\r\n\r\nfunction fillRandomCell() {\r\n  const emptyCells = [...gameField]\r\n    .flat()\r\n    .filter(cell => !cell.textContent);\r\n\r\n  if (emptyCells.length === 0) {\r\n    return false;\r\n  }\r\n\r\n  emptyCells[getRandom(emptyCells.length)].textContent = random2And4();\r\n  addStyleCell();\r\n\r\n  return true;\r\n}\r\n\r\nfunction clearCell() {\r\n  gameField.forEach(row => {\r\n    row.forEach(cell => {\r\n      cell.textContent = '';\r\n    });\r\n  });\r\n}\r\n\r\nfunction removeStyleCell() {\r\n  gameField.forEach(e => {\r\n    e.forEach(a => {\r\n      if (a.textContent !== '') {\r\n        a.className = 'field-cell';\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nfunction addStyleCell() {\r\n  gameField.forEach(e => {\r\n    e.forEach(a => {\r\n      if (a.textContent !== '') {\r\n        a.classList.add(`field-cell--${a.textContent}`);\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nfunction addScore(num) {\r\n  score.textContent = +score.textContent + +num;\r\n\r\n  return score.textContent;\r\n}\r\n\r\nfunction gameOver(num, over = false) {\r\n  if (num === '2048') {\r\n    win.classList.remove('hidden');\r\n    startGamePress = false;\r\n\r\n    return;\r\n  }\r\n\r\n  if (over) {\r\n    lose.classList.remove('hidden');\r\n    startGamePress = false;\r\n  }\r\n}\r\n"]}